
## design patterns - 设计模式
##### 设计模式解决的是什么问题？
简单说，是面向对象编程过程中的设计(design)问题
什么是design？可以理解为除了数据结构与算法，计算机网络，操作系统之外的问题
也就是我们还未遇到的问题

#### dynamic_cast
我们知道子类对象可以“退化”成父类指针
因为子类对象的存储空间头部存储的是父类的相关信息
但是父类指针怎么变成指向子类对象的呢
这里就要用到`dynamic_cast`

```shell
9.visitor.cpp:33:13: error: 'A' is not polymorphic
        if (dynamic_cast<B *>(arr[i])) {
            ^                 ~~~~~~
```

但是这样报错A不是多态的，我们知道多态是通过虚函数或者说虚函数表实现的
那为什么`dynamic_cast`需要类是多态的，或者说需要虚函数表呢？
因为只有在多态的情况下`class B, C, D`它们头部的虚函数表才都不一样
那么`dynamic_cast`的工作原理就是判断虚函数表是不是和某类一样，所以
它需要多态
又因为 了在调用`delete`的时候正确的析构
子类对象的空间，并且每个子类都必定调用析构函数
所以将析构函数显式的声明成虚函数
一石二鸟 
`virtual A() {}`
-------
#### 访问者模式


